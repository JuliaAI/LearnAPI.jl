<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fit, update and ingest · LearnAPI.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LearnAPI.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../anatomy_of_an_implementation/">Anatomy of an Implementation</a></li><li><a class="tocitem" href="../common_implementation_patterns/">Common Implementation Patterns</a></li><li><a class="tocitem" href="../reference/">Reference</a></li><li class="is-active"><a class="tocitem" href>Fit, update and ingest</a></li><li><a class="tocitem" href="../operations/">Predict and other operations</a></li><li><a class="tocitem" href="../model_traits/">Model Traits</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Fit, update and ingest</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fit, update and ingest</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaAI/LearnAPI.jl/blob/dev/docs/src/fit_update_and_ingest.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Fit,-update!-and-ingest!"><a class="docs-heading-anchor" href="#Fit,-update!-and-ingest!">Fit, update! and ingest!</a><a id="Fit,-update!-and-ingest!-1"></a><a class="docs-heading-anchor-permalink" href="#Fit,-update!-and-ingest!" title="Permalink"></a></h1><blockquote><p><strong>Summary.</strong> Models that learn, i.e., generalize to new data, must overload <code>fit</code>; the fallback performs no operation and returns all <code>nothing</code>. Implement <code>update!</code> if certain hyper-parameter changes do not necessitate retraining from scratch (e.g., increasing iteration parameters). Implement <code>ingest!</code> to implement incremental learning.</p></blockquote><table><tr><th style="text-align: left">method</th><th style="text-align: left">fallback</th><th style="text-align: right">compulsory?</th><th style="text-align: right">requires</th></tr><tr><td style="text-align: left"><a href="#LearnAPI.fit"><code>LearnAPI.fit</code></a></td><td style="text-align: left">does nothing, returns <code>(nothing, nothing, nothing)</code></td><td style="text-align: right">no</td><td style="text-align: right"></td></tr><tr><td style="text-align: left"><a href="#LearnAPI.update!"><code>LearnAPI.update!</code></a></td><td style="text-align: left">calls <code>fit</code></td><td style="text-align: right">no</td><td style="text-align: right"><code>LearnAPI.fit</code></td></tr><tr><td style="text-align: left"><a href="#LearnAPI.ingest!"><code>LearnAPI.ingest!</code></a></td><td style="text-align: left">none</td><td style="text-align: right">no</td><td style="text-align: right"><code>LearnAPI.fit</code></td></tr></table><p>All three methods above return a triple <code>(fitted_params, state, report)</code> whose components are explained under <a href="#LearnAPI.fit"><code>LearnAPI.fit</code></a> below.  Items that might be returned in <code>report</code> include: feature rankings/importances, SVM support vectors, clustering centres, methods for visualizing training outcomes, methods for saving learned parameters in a custom format, degrees of freedom, deviances. Precisely what <code>report</code> includes might be controlled by model hyperparameters, especially if there is a performance cost to it&#39;s inclusion.</p><p>Implement <code>fit</code> unless all <a href="../operations/#operations">operations</a>, such as <code>predict</code> and <code>transform</code>, ignore their <code>fitted_params</code> argument (which will be <code>nothing</code>). This is the case for many models that have hyperparameters, but do not generalize to new data, such as a basic DBSCAN clustering algorithm.</p><p>The <code>update!</code> method is intended for all subsequent calls to train a model <em>using the same observations</em>, but with possibly altered hyperparameters (<code>model</code> argument). A fallback implementation simply calls <code>fit</code>. The main use cases for implementing <code>update</code> are: (i) warm-restarting iterative models, and (ii) &quot;smart&quot; training of composite models, such as linear pipelines. Here &quot;smart&quot; means that hyperparameter changes only trigger the retraining of downstream components.</p><p>The <code>ingest!</code> method supports incremental learning (same hyperparameters, but new training observations). Like <code>update!</code>, it depends on the output a preceding <code>fit</code> or <code>ingest!</code> call.</p><article class="docstring"><header><a class="docstring-binding" id="LearnAPI.fit" href="#LearnAPI.fit"><code>LearnAPI.fit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">LearnAPI.fit(model, verbosity, data...; metadata...)</code></pre><p>Fit <code>model</code> to the provided <code>data</code> and <code>metadata</code>. With the exception of warnings, training should be silent if <code>verbosity == 0</code>. Lower values should suppress warnings; any integer ought to be admissible. Here:</p><ul><li><p><code>model</code> is a property-accessible object whose properties are the hyper-parameters of some  machine learning algorithm; see also <a href="@ref"><code>LearnAPI.ismodel</code></a>.</p></li><li><p><code>data</code> is a tuple of data objects with a common number of observations, for example, <code>data = (X, y, w)</code> where <code>X</code> is a table of features, <code>y</code> is a target vector with the same number of rows, and <code>w</code> a vector of per-observation weights.</p></li><li><p><code>metadata</code> is for extra information pertaining to the data that is never iterated, for example, weights for target classes. Another example would be feature groupings in the group lasso algorithm.</p></li></ul><p><strong>Return value</strong></p><p>Returns a tuple (<code>fitted_params</code>, <code>state</code>, <code>report</code>) where:</p><ul><li><p>The <code>fitted_params</code> is the model&#39;s learned parameters (eg, the coefficients in a linear model) in a form understood by model operations. An <em>operation</em> is a method, like <a href="../operations/#LearnAPI.predict"><code>LearnAPI.predict</code></a> or <a href="../operations/#LearnAPI.transform"><code>LearnAPI.transform</code></a>, that has signature <code>(model, fitted_params, data....)</code>; do <code>LearnAPI.OPERATIONS</code> to list. If some training outcome of user-interest is not needed for operations, it should be part of <code>report</code> instead (see below).</p></li><li><p>The <code>state</code> is for passing to <a href="#LearnAPI.update!"><code>LearnAPI.update!</code></a> or <a href="#LearnAPI.ingest!"><code>LearnAPI.ingest!</code></a>. For models that implement neither, <code>state</code> should be <code>nothing</code>.</p></li><li><p>The <code>report</code> records byproducts of training not in the <code>fitted_params</code>.</p></li></ul><p><strong>New model implementations</strong></p><p>Overloading this method for new models is optional.  A fallback performs no computation, returning <code>(nothing, nothing, nothing)</code>.</p><p>Note that in LearnAPI.jl the word &quot;data&quot; is only defined informally, as an object generating &quot;observations&quot;, which are not defined at all.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The method is not permitted to mutate <code>model</code>. In particular, if <code>model</code> has a random number generator as a hyperparameter (property) then it must be copied before use.  </p></div></div><p>If implemented, include <code>:fit</code> in the tuple returned by the <a href="@ref"><code>LearnAPI.methods</code></a> trait. </p><p>See also <a href="#LearnAPI.update!"><code>LearnAPI.update!</code></a>, <a href="#LearnAPI.ingest!"><code>LearnAPI.ingest!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/LearnAPI.jl/blob/d729c12baddae7bd3f804f1d277205af6b7fb59b/src/fit_update_ingest.jl#LL30-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LearnAPI.update!" href="#LearnAPI.update!"><code>LearnAPI.update!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">LearnAPI.update!(model, verbosity, fitted_params, state, data...; metadata...)d Based on the values of `state`, and `fitted_params` returned by a preceding call to</code></pre><p><a href="ref"><code>LearnAPI.fit</code></a>, <a href="#LearnAPI.ingest!"><code>LearnAPI.ingest!</code></a>, or <a href="#LearnAPI.update!"><code>LearnAPI.update!</code></a>, update a model&#39;s learned parameters, returning new (or mutated) <code>state</code> and <code>fitted_params</code>.</p><p>Intended for retraining a model when the training data has not changed, but <code>model</code> properties (hyperparameters) may have changed. Specifically, the assumption is that <code>data</code> and <code>metadata</code> have the same values seen in the most recent call to <code>fit/update!/ingest!</code>.</p><p>The most common use case is for continuing the training of an iterative model: <code>state</code> is simply a copy of the model used in the last training call (<code>fit</code>, <code>update!</code> or <code>ingest!</code>) and this will include the current number of iterations as a property. If <code>model</code> and <code>state</code> differ only in the number of iterations (e.g., epochs in a neural network), which has increased, then the learned parameters (weights) are updated, rather computed ab initio. Otherwise, <code>update!</code> simply calls <code>fit</code>, to force retraining from scratch.</p><p>It is permitted to return mutated versions of <code>state</code> and <code>fitted_params</code>.</p><p>For incremental training (same model, new data) see instead <a href="#LearnAPI.ingest!"><code>LearnAPI.ingest!</code></a>.</p><p><strong>Return value</strong></p><p>Same as <a href="#LearnAPI.fit"><code>LearnAPI.fit</code></a>, namely a tuple (<code>fitted_params</code>, <code>state</code>, <code>report</code>). See <a href="#LearnAPI.fit"><code>LearnAPI.fit</code></a> for details.</p><p><strong>New model implementations</strong></p><p>Overloading this method is optional. A fallback calls <code>LearnAPIperforms.fit</code>:</p><pre><code class="language-julia hljs">LearnAPI.update!(model, verbosity, fitted_params, state, data...; metadata...) =
    fit(model, verbosity, data; metadata...)</code></pre><p>Note that in LearnAPI.jl the word &quot;data&quot; is only defined informally, as an object generating &quot;observations&quot;, which are not defined at all.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The method is not permitted to mutate <code>model</code>. In particular, if <code>model</code> has a random number generator as a hyperparameter (property) then it must be copied before use.  </p></div></div><p>If implemented, include <code>:fit</code> in the tuple returned by the <a href="@ref"><code>LearnAPI.methods</code></a> trait. </p><p>See also <a href="#LearnAPI.fit"><code>LearnAPI.fit</code></a>, <a href="#LearnAPI.ingest!"><code>LearnAPI.ingest!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/LearnAPI.jl/blob/d729c12baddae7bd3f804f1d277205af6b7fb59b/src/fit_update_ingest.jl#LL84-L128">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LearnAPI.ingest!" href="#LearnAPI.ingest!"><code>LearnAPI.ingest!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">LearnAPI.ingest!(model, verbosity, fitted_params, state, data...; metadata...)</code></pre><p>For a model that supports incremental learning, update the learned parameters using <code>data</code>, which has typically not been seen before.  The arguments <code>state</code> and <code>fitted_params</code> are the output of a preceding call to <a href="ref"><code>LearnAPI.fit</code></a>, <a href="#LearnAPI.ingest!"><code>LearnAPI.ingest!</code></a>, or <a href="#LearnAPI.update!"><code>LearnAPI.update!</code></a>, of which mutated or new versions are returned.</p><p>For updating learned parameters using the <em>same</em> data but new hyperparameters, see instead <a href="#LearnAPI.update!"><code>LearnAPI.update!</code></a>.</p><p>For incremental training, see instead <a href="@ref">`LearnAPI.ingest&#39;</a>.</p><p><strong>Return value</strong></p><p>Same as <a href="#LearnAPI.fit"><code>LearnAPI.fit</code></a>, namely a tuple (<code>fitted_params</code>, <code>state</code>, <code>report</code>). See <a href="#LearnAPI.fit"><code>LearnAPI.fit</code></a> for details.</p><p><strong>New model implementations</strong></p><p>Implementing this method is an optional. It has no fallback.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The method is not permitted to mutate <code>model</code>. In particular, if <code>model</code> has a random number generator as a hyperparameter (property) then it must be copied before use.  </p></div></div><p>If implemented, include <code>:fit</code> in the tuple returned by the <a href="@ref"><code>LearnAPI.methods</code></a> trait. </p><p>See also <a href="#LearnAPI.fit"><code>LearnAPI.fit</code></a>, <a href="#LearnAPI.update!"><code>LearnAPI.update!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/LearnAPI.jl/blob/d729c12baddae7bd3f804f1d277205af6b7fb59b/src/fit_update_ingest.jl#LL135-L166">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../reference/">« Reference</a><a class="docs-footer-nextpage" href="../operations/">Predict and other operations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 2 December 2022 04:37">Friday 2 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
